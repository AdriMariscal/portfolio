---
// src/components/PostCard.astro
import type { CollectionEntry } from "astro:content";

const { entry, maxTags = 6 } = Astro.props as {
  entry: CollectionEntry<"blog">;
  maxTags?: number;
};

const { data, slug } = entry;
const tags: string[] = Array.isArray(data.tags) ? data.tags : [];
const tagSlice = tags.slice(0, maxTags);

const slugifyTag = (t: string) =>
  t.toLowerCase().trim().normalize("NFD").replace(/\p{Diacritic}/gu, "").replace(/[^a-z0-9]+/g, "-").replace(/(^-|-$)/g, "");
---

<article class="card card--post">
  <div class="card__body">
    <h3 class="card__title postcard__title">
      <a href={`/blog/${slug}/`}>{data.title}</a>
  </h3>

    {data.description && (
      <p class="postcard__excerpt">{data.description}</p>
    )}

    {tagSlice.length > 0 && (
      <ul class="taglist" aria-label="Etiquetas">
        {tagSlice.map((t) => (
          <li>
            <a class="tag" href={`/blog/tags/${slugifyTag(t)}/`}>#{t}</a>
          </li>
      ))}
    </ul>
  )}
    </div>
</article>