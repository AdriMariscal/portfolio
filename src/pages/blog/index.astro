---
import BaseLayout from "../../layouts/BaseLayout.astro";
import PostCard from "../../components/PostCard.astro";
import { getCollection } from "astro:content";

// 9 últimos posts, más nuevos primero (ignora borradores si usas `draft: true`)
const posts = (await getCollection("blog"))
  .filter((p) => !p.data.draft)
  .sort((a, b) => {
    const ad = new Date(a.data.date ?? 0).getTime();
    const bd = new Date(b.data.date ?? 0).getTime();
    return bd - ad;
  })
  .slice(0, 9);
---

<BaseLayout title="Blog">
  <main class="section">
    <div class="wrap">
      <h1 class="h2" style="font-size:2rem;margin-bottom:18px">Blog</h1>

      <!-- cuadrícula 3x3 igual que en “Últimos artículos” -->
      <div class="grid grid--3" style="--stack-gap:16px">
        {posts.map((entry) => <PostCard entry={entry} />)}
        </div>
    </div>
  </main>
</BaseLayout>
