---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { getEntry, getCollection } from "astro:content";

// 游녢 Necesario en rutas din치micas est치ticas
export async function getStaticPaths() {
  const projects = await getCollection(
    "projects",
    ({ data }) => data.published !== false,
  );
  return projects.map((p) => ({ params: { slug: p.slug } }));
}

const { slug } = Astro.params;
if (!slug) throw new Error("Missing slug");

const project = await getEntry("projects", slug);
if (!project) throw new Error(`Project not found: ${slug}`);

const { Content } = await project.render();
const { title, description, tags, repoUrl, demoUrl } = project.data;
---

<BaseLayout title={`${title} 췅 Proyecto 췅 Adri치n Mariscal`} current="projects">
  <article class="prose max-w-none">
    <h1>{title}</h1>
    <p class="text-gray-600">{description}</p>
    {tags?.length && <p class="mt-2">{tags.map((t) => `#${t}`).join(" ")}</p>}
    <p class="mt-3">
      {
        repoUrl && (
          <a class="underline mr-4" href={repoUrl} target="_blank">
            C칩digo
          </a>
        )
      }
      {
        demoUrl && (
          <a class="underline" href={demoUrl} target="_blank">
            Demo
          </a>
        )
      }
    </p>
    <section class="prose">
      <Content />
    </section>
  </article>
</BaseLayout>
